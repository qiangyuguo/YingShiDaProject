$(function(){function ah(a){return a.val()}function J(b,a){b.each(function(){$(this).text(a)})}$(".gengduoxian a span").click(function(){if($(this).attr("class")=="fa fa-chevron-down"){$(this).attr("class","fa fa-chevron-up")}else{$(this).attr("class","fa fa-chevron-down")}if($(".hide-click").css("display")=="none"){$(".hide-click").show()}else{$(".hide-click").hide()}});$(".full-question-mark,.question-mark").hover(function(){Yn.tips($(".triangle-branch").text(),this,{guide:2,time:0,more:true})},function(){Yn.closeTips()});function ae(a){return a.css("background-color")}function R(a,b){a.each(function(){$(this).css({"background-color":b})})}var N=$(".changecolor");R(N,"#"+$("#color").val());$(".colorpart").each(function(){this.onclick=function(){var a=aj(ae($(this)));R(N,ae($(this)));$("#color").val(a);$(".colorpart").removeClass("active");$(this).addClass("active")}});function aj(b){b=b.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);function a(c){return(parseInt(c).toString(16)).slice(-2)}return a(b[1])+a(b[2])+a(b[3])}var Q=$(".grouptitle"),O=$(".card-title"),U=$(".font-youhui");$("#member").blur(function(){J(O,ah($(this)))});$("#subTitle").blur(function(){J(U,ah($(this)))});$("#box-checks").bind("click",function(){if(Q.css("display")!=="none"){$("input[name=coverShow]:hidden").val(0);Q.css("display","none")}else{$("input[name=coverShow]:hidden").val(1);Q.css("display","block")}});var G=$(".periodbox").find(".list"),S=$(".radio")||$('input[name="validity-period"]'),M=0,aa=$("#dateInfoBeginTimestamp"),I=$("#dateInfoEndTimestamp"),F=$("#dateInfoTimestamp"),H=$("#dateInfoFixedTerm");function L(a){this.defaults={target:a.target};this.init()}L.prototype.init=function(){var b=this,a=b.defaults;b.addClickEvent();b.addBlurEvent();if(b.getActiveRadio()===0){b.setFixedTime()}else{b.setFixedLength()}};L.prototype.getActiveRadio=function(){return M=($("#dateInfoType").val()-1)||M};L.prototype.addClickEvent=function(){var a=this;S.each(function(b){$(this).bind("click",function(){$("#dateInfoType").val($(this).attr("data"));dateInfoTypeToggle($("#dateInfoType").val());a.changeActiveRadio(b)})})};L.prototype.changeActiveRadio=function(a){G.removeClass("block").eq(a).addClass("block");M=a};L.prototype.addBlurEvent=function(){var a=this;aa.add(I).blur(function(){a.setFixedTime()});F.add(H).blur(function(){a.setFixedLength()})};L.prototype.setFixedTime=function(){var b=this,a=b.defaults;setTimeout(function(){if(aa.val()&&I.val()){J(a.target,aa.val()+" 到 "+I.val())}},500)};L.prototype.setFixedLength=function(){var b=this,a=b.defaults;if(F.val()){J(a.target,F.val()+"天")}if(H.val()){J(a.target,H.val()+"天")}else{if(H.val()==""){J(a.target,"永久有效")}}};var X=new L({target:$(".timemunber")});var Y="",T;function ag(a){T=a.files[0];if(!/image\/\w+/.test(T.type)){return false}var b=new FileReader();b.readAsDataURL(T);return b}var ai=["#subfile","#detailsfile","#coverMapfile"],af=[".fontColor",".graphic-details-img",".coverMap-img"];$.each(ai,function(a){$(ai[a]).bind("change",function(){ag(this).onload=function(b){Y=this.result;$(af[a]).each(function(){var c=$(this);c.css({"background-image":"url("+Y+")","background-size":"100% 100%"});if(a==1){c.attr("data-src",Y);$("#graphic-hidden").val(Y)}if(a==2){c.attr("data-bg",Y);$("#backgroundPic").val(Y)}})}})});var K=$("#backgroundPic"),ac=K.val();if(K.val()!=""){$(".coverMap-img").css({"background-image":"url("+ac+")","background-size":"100% 100%"})}else{var ad=$("#backGroundPicUrl");ad.css({"background-image":"#"+$("#color").val()})}var Z=$(".writetitle");$("#fortitle").add("#member").blur(function(){J(Z,$(this).val())});var V=$("#fortip"),W=$(".tipct");V.blur(function(){J(W,$(this).val())});function P(){var a=$("[name='title']");if(a.val()){var b=$(".writetitle");J(b,a.val())}}function ab(){var a=$("[name='couponType']").val();if(a=="cash"){if($("[name='cashReduceCost']").val()){$(".main").text($("[name='cashReduceCost']").val())}}else{if(a=="discount"){if($("[name='discountTemp']").val()){$(".main").text($("[name='discountTemp']").val())}}else{if(a=="gift"){if($("[name='gift']").val()){$(".main").text($("[name='gift']").val())}}else{if(a=="general_coupon"){if($("[name='subTitle']").val()){$(".main").text($("[name='subTitle']").val())}}}}}}P();ab()});